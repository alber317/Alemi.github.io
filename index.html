<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Dedicatoria — Para mi persona favorita</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

<style>
  :root{
    --bg:#FFF8FB;
    --card:#ffffff;
    --accent:#F06292;
    --accent-2:#7C4DFF;
    --muted:#5B6270;
    --text:#111827;
    --radius:16px;
    --maxw:980px;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;
    background:linear-gradient(180deg,var(--bg),#fff);
    color:var(--text);
    display:flex;
    justify-content:center;
    padding:28px;
  }

  .site{
    width:100%;
    max-width:var(--maxw);
    background:var(--card);
    border-radius:18px;
    box-shadow:0 18px 60px rgba(20,20,40,0.08);
    overflow:hidden;
  }

  header{
    padding:28px;
    border-bottom:1px solid #f1e8ee;
    background:linear-gradient(90deg,#fff,#fff7fb);
  }
  h1{ margin:0 0 6px; font-size:28px; color:var(--accent-2); }
  .subtitle{ margin:0; color:var(--muted); }

  main{ padding:26px; display:block; gap:18px; }

  .block{
    margin-bottom:20px;
    display:flex;
    flex-direction:column;
    gap:12px;
  }

  .text{
    font-size:16px;
    line-height:1.6;
    color:var(--text);
    background:linear-gradient(180deg,#fff,#fff);
    padding:14px 16px;
    border-radius:12px;
  }

  .imgwrap{
    display:flex;
    gap:12px;
    flex-wrap:wrap;
  }
  .imgwrap img{
    border-radius:12px;
    width:200px;
    height:200px;
    object-fit:cover;
    box-shadow:0 10px 30px rgba(20,20,40,0.06);
    transition:transform .35s ease, box-shadow .35s ease;
  }
  .imgwrap img:hover{ transform:translateY(-6px) scale(1.02); box-shadow:0 22px 50px rgba(20,20,40,0.12); }

  .play-area{
    display:flex;
    gap:18px;
    align-items:center;
    padding:18px;
    background:linear-gradient(90deg, rgba(240,240,250,0.6), rgba(255,250,250,0.6));
    border-radius:12px;
  }

  .action-btn{
    background:linear-gradient(180deg,var(--accent),var(--accent-2));
    color:white;
    border:none;
    padding:14px 18px;
    border-radius:12px;
    font-weight:700;
    cursor:pointer;
    font-size:16px;
    box-shadow:0 10px 30px rgba(124,77,255,0.18);
  }
  .action-btn:active{ transform:translateY(2px); }

  .heart{
    width:72px;
    height:72px;
    display:grid;
    place-items:center;
    border-radius:12px;
    background:rgba(240,240,250,0.6);
    position:relative;
    overflow:visible;
  }

  .heart svg{ width:56px; height:56px; transform-origin:center; opacity:0; }

  .lyrics{
    flex:1;
    min-height:70px;
    padding:12px;
    border-radius:10px;
    background:linear-gradient(180deg,#fff,#fff);
    box-shadow:inset 0 1px 0 rgba(0,0,0,0.02);
    font-weight:600;
    color:var(--muted);
  }

  /* Texto de las líneas: gradiente acorde a la paleta (rosa -> morado).
     Tiene fallback de color para navegadores sin support. */
  .line{
    opacity:0;
    transform:translateY(6px);
    transition:all .45s ease;
    margin:6px 0;
    font-weight:700;
    font-size:17px;
    /* gradient text */
    background: linear-gradient(90deg, var(--accent), var(--accent-2));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    color: transparent;
    text-shadow: 0 1px 0 rgba(0,0,0,0.02);
  }
  /* fallback color for browsers not supporting background-clip */
  .line.fallback { color: var(--accent); background:none; -webkit-text-fill-color: unset; }

  .line.visible{ opacity:1; transform:translateY(0); }

  footer{ padding:16px; font-size:13px; color:var(--muted); border-top:1px solid #f3eef3; display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:8px; }

  @media (max-width:760px){
    .imgwrap img{ width:48%; height:140px; }
    .heart{ width:56px; height:56px; }
    .heart svg{ width:44px; height:44px; }
  }

  @keyframes heart-pop {
    0% { transform: scale(0.2); opacity:0; filter:blur(6px); }
    40% { transform: scale(1.14); opacity:1; filter:blur(0); }
    70% { transform: scale(.92); }
    100% { transform: scale(1); opacity:1; }
  }

  @keyframes heart-pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.06); }
    100% { transform: scale(1); }
  }

  .heart svg.show {
    animation: heart-pop .55s ease forwards, heart-pulse 1.2s 0.6s ease-in-out infinite;
  }

  /* pequeño hint de debug (se muestra si algo falla) */
  #debugHint { position:fixed; right:12px; bottom:12px; z-index:9999; background:rgba(0,0,0,0.6); color:#fff; padding:8px 10px; border-radius:8px; font-size:13px; display:none; }
  #debugHint.show { display:block; }

</style>
</head>
<body>
  <div class="site" id="site">
    <header>
      <h1 id="pageTitle">Para mi persona favorita</h1>
      <p class="subtitle" id="pageSub">Espero que te guste</p>
    </header>

    <main id="mainContent">

      <section class="block">
        <div class="text" id="para1">
          Nunca crei encontrar una persona con la cual puedo llegar a ser yo mismo sin sentir pena o verguenza pues de todas las casualidades del Universo, la mejor fue coincidir contigo, y nosotros siempre seremos como:
        </div>
      </section>

      <section class="block">
        <div class="imgwrap" id="imgs1">
          <img src="https://images5.alphacoders.com/132/1326575.png" alt="imagen1">
        </div>
      </section>

      <section class="block">
        <div class="text" id="para2">
          A pesar de los problemas o peleas nunca nos dejamos de hablar porque para mi eres muy importante y no puedo imaginar mi dia dia sin hablar contigo
        </div>
      </section>

      <section class="block">
        <div class="imgwrap" id="imgs2">
          <img src="https://i.pinimg.com/736x/57/56/cf/5756cf550e06ceaa5ed63526d59d9af0.jpg" alt="imagen2">
          <img src="https://i.pinimg.com/280x280_RS/b3/40/e7/b340e7fe543acb710569dcbfe776bafe.jpg" alt="imagen3">
        </div>
      </section>

      <section class="block">
        <div class="text" id="para3">
          Aunque aun me falte mucho mas que aprender o conocer sobre ti, siempre me encatara la idea de saber las cosas que te hacen reir, llorar, las cosas que te preocupan, tus problemas, tus sueños, y mucho mas
          <br><br>
          Espero que en este nuevo año sigamos hablando como siempre, y nunca separarnos por un 2026 lleno de nuevas Historias
        </div>
      </section>

      <section class="block">
        <div class="imgwrap" id="imgs3">
          <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS4CYoBDZu6Cd8eag_bUXe-coZBeHFgXa6xAr1_wSnn56ql_IO_T2BQJ6vcQ5MS_GMOcrw" alt="imagen4">
        </div>
      </section>

      <section class="block">
        <div class="play-area">
          <div class="heart" id="heartBox" title="Se mostrará un corazón">
            <svg id="heartSvg" viewBox="0 0 32 29.6" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <path fill="url(#g)" d="M23.6 0c-2.7 0-5 1.5-6.6 3.8C15.4 1.5 13.1 0 10.4 0 4.7 0 0 4.8 0 10.8 0 18.6 9.6 23.6 16 29.6c6.4-6 16-11 16-18.8C32 4.8 27.3 0 21.6 0z"/>
              <defs>
                <linearGradient id="g" x1="0" x2="1">
                  <stop offset="0" stop-color="#ff5a97"/>
                  <stop offset="1" stop-color="#7C4DFF"/>
                </linearGradient>
              </defs>
            </svg>
          </div>

          <button class="action-btn" id="playBtn">Apreta aquí</button>

          <div class="lyrics" id="lyricsBox">
            <div id="linesContainer"></div>
          </div>
        </div>

        <audio id="track" preload="metadata">
          <source id="audioSrc" src="https://raw.githubusercontent.com/alber317/Alemi.github.io/main/Ricky Montgomery - Mr Loverman (Official Lyric Video).mp3" type="audio/mpeg">
          Tu navegador no soporta reproducción de audio.
        </audio>

      </section>

    </main>

    <footer>
      <div>Hecho con ❤️</div>
      <div style="font-size:12px;color:var(--muted)">Alemi</div>
    </footer>
  </div>

  <div id="debugHint" role="status" aria-live="polite"></div>

<script>
/* ================= CONFIG y DATOS ================= */

// Mantener la URL como referencia, aunque el elemento <audio> ya la tiene.
const RAW_GITHUB_URL_OVERRIDE = 'https://raw.githubusercontent.com/alber317/Alemi.github.io/main/Ricky%20Montgomery%20-%20Mr%20Loverman%20(Official%20Lyric%20Video).mp3';
const defaultDelayBetweenLines = 2000; // ms fallback

// FIX SINCRONIZACIÓN: Timestamps (tiempo en segundos) añadidos para Mr. Loverman
const lyricsData = [
  { time: 0.0, text: "I'm headed straight for the floor" },
  { time: 5.8, text: "The alcohol served its tour" },
  { time: 11.9, text: "And it's headed straight for my skin" },
  { time: 16.7, text: "Leaving me daft and dim" },
  { time: 22.8, text: "I've got this shake in my legs" },
  { time: 28.1, text: "Shaking the thoughts from my head" },
  { time: 34.0, text: "But who put these waves in the door?" },
  { time: 40.0, text: "I crack and out I pour" },
  { time: 44.8, text: "I'm Mr. Loverman" },
  { time: 50.0, text: "And I miss my lover, man" },
  { time: 56.0, text: "I'm Mr. Loverman" },
  { time: 60.9, text: "Oh, and I miss my lover" },
  { time: 66.8, text: "The ways in which you talk to me" },
  { time: 71.0, text: "Have me wishin' I were gone" },
  { time: 78.0, text: "The ways that you say my name" },
  { time: 82.8, text: "Have me runnin' on and on" },
  { time: 90.0, text: "Oh, I'm cramping up, I'm cramping up" },
  { time: 101.0, text: "But you're cracking up, you're cracking up" },
  { time: 110.0, text: "I'm Mr. Loverman" },
  { time: 116.0, text: "And I miss my loverman" },
  { time: 122.7, text: "I'm Mr. Loverman" },
  { time: 128.0, text: "Oh, and I miss my lover" },
  { time: 135.0, text: "I've shattered now, I'm spilling out" },
  { time: 140.4, text: "Upon this linoleum ground (Mr. Loverman)" },
  { time: 146.7, text: "I'm reeling in my brain again" },
  { time: 152.0, text: "Before it can get back to you (Mr. Loverman)" },
  { time: 156.0, text: "Oh, what am I supposed to do without you?" },
  { time: 167.0, text: "I'm Mr. Loverman" },
  { time: 172.4, text: "And I miss my lover, man (I miss my lover)" },
  { time: 178.1, text: "I'm Mr. Loverman (oh-oh)" },
  { time: 183.0, text: "Oh, and I miss my lover (Mr. Loverman)" },
  { time: 189.0, text: "I'm Mr. Loverman" }
];


(function(){ // Función anónima autoejecutable

  /* === DOM refs === */
  const btn = document.getElementById('playBtn');
  const heartSvg = document.getElementById('heartSvg');
  const audioEl = document.getElementById('track');
  // const audioSrc = document.getElementById('audioSrc'); // ELIMINADO
  const linesContainer = document.getElementById('linesContainer');
  const debugEl = document.getElementById('debugHint');
  
  /* --- util debug en pantalla --- */
  function showDebug(msg, isError){
    if(!debugEl) return;
    debugEl.textContent = msg;
    debugEl.classList.add('show');
    debugEl.style.background = isError ? 'rgba(160,20,20,0.9)' : 'rgba(0,0,0,0.6)';
    setTimeout(()=> debugEl.classList.remove('show'), 5000);
    console[isError?'error':'log']('[PAGE]', msg);
  }

  /* --- configurar y cargar audio --- */
  // LA FUNCIÓN setAudio() FUE ELIMINADA PARA EVITAR CONFLICTOS DE CARGA.
  
  /* === preparar y pintar líneas === */
  function setupLines(lines){
    linesContainer.innerHTML = '';
    const arr = Array.isArray(lines) && lines.length ? lines : lyricsData || [];
    if(!arr || arr.length===0){
      const hint = document.createElement('div');
      hint.style.opacity = .6;
      hint.textContent = 'Las letras no fueron cargadas.';
      linesContainer.appendChild(hint);
      return;
    }
    arr.forEach((ln, idx) => {
      const d = document.createElement('div');
      d.className = 'line';
      d.dataset.idx = idx;
      d.textContent = ln.text || '';
      linesContainer.appendChild(d);
    });
  }
  setupLines(lyricsData);

  /* === animaciones y sincronización === */
  function animateHeart(){
    if(!heartSvg) return;
    heartSvg.classList.remove('show');
    void heartSvg.offsetWidth;
    heartSvg.classList.add('show');
  }

  function revealSequentialByInterval(intervalMs){
    const nodes = Array.from(document.querySelectorAll('.line'));
    nodes.forEach((el, idx) => {
      setTimeout(()=> el.classList.add('visible'), Math.max(0, Math.round(idx * intervalMs)));
    });
  }

  let syncHandler = null;
  function revealByTimestampsFromArray(arr){
    // Limpia el listener anterior para evitar duplicados
    if (syncHandler) audioEl.removeEventListener('timeupdate', syncHandler);
    
    document.querySelectorAll('.line').forEach(x=> x.classList.remove('visible'));
    
    syncHandler = function(){
      const t = audioEl.currentTime;
      arr.forEach((ln, idx) => {
        if (ln.time !== undefined && t >= ln.time){
          const el = document.querySelector('.line[data-idx="'+idx+'"]');
          if (el && !el.classList.contains('visible')) el.classList.add('visible');
        }
      });
      // Detener la sincronización cuando termina el audio
      if (audioEl.ended) {
        audioEl.removeEventListener('timeupdate', syncHandler);
        syncHandler = null;
      }
    };
    audioEl.addEventListener('timeupdate', syncHandler);
  }

  /* === click handler principal === */
  if(!btn || !audioEl){ showDebug('Elementos principales (botón/audio) faltan.', true); return; }

  btn.addEventListener('click', async function(){
    btn.disabled = true;
    btn.style.opacity = '0.85';

    // 1) Comprobación de la fuente de audio (simplificada)
    // Comprobamos que audioEl.currentSrc o audioEl.src tiene una URL que no está vacía.
    const hasValidSrc = audioEl.currentSrc && audioEl.currentSrc.length > 5 || audioEl.src && audioEl.src.length > 5;
    
    if (hasValidSrc){
      
      try { 
        // Se prioriza la reproducción al clic para evitar el bloqueo de Autoplay.
        audioEl.currentTime = 0; // Reiniciar
        const playPromise = audioEl.play();
        
        if (playPromise !== undefined) {
          await playPromise;
        }

        showDebug('Audio reproduciéndose. Letras sincronizadas.');
        
        // 2) Animación del corazón (la movemos AHORA, después de que el audio empieza a sonar)
        animateHeart();
        await new Promise(r=> setTimeout(r, 420));
        
        // 3) Muestra las letras con los timestamps exactos
        const arr = lyricsData;
        const hasTimes = arr.some(x => x && x.time !== undefined);

        if (hasTimes){
          revealByTimestampsFromArray(arr);
        } else {
          // Fallback (No debería suceder)
          revealSequentialByInterval(defaultDelayBetweenLines);
        }

      } catch(err){
        console.error('Error de reproducción:', err);
        showDebug('No se pudo reproducir audio (Autoplay bloqueado). Mostrando letras automáticas.', true);
        // Si falla la reproducción, se muestra el texto automáticamente
        animateHeart();
        revealSequentialByInterval(defaultDelayBetweenLines);
      }

    } else {
      // No hay audio: solo muestra letras con retardo fijo
      showDebug('Error: No se detectó una fuente de audio válida en el elemento.', true);
      revealSequentialByInterval(defaultDelayBetweenLines);
    }

    // Re-habilita el botón (para que pueda volver a reproducir al recargar la página)
    setTimeout(()=> { btn.disabled=false; btn.style.opacity='1'; }, 3000);
  });

  showDebug('Script cargado y listo — pulsa el botón.');

})(); // CIERRE CORRECTO DE LA FUNCIÓN
</script>
  </body>
</html>
